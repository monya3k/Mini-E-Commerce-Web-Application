{% extends "base.html" %}
{% block content %}
<h2 class="mb-4">Products</h2>
<div class="row">
  {% for p in products %}
  <div class="col-md-4">
    <div class="card shadow-sm">
      <div class="card-body">
        <h5 class="card-title">{{ p[1] }}</h5>
        <p class="card-text">Price: ${{ p[2] }}<br>Stock: {{ p[3] }}</p>

        {% if role == "Customer" %}
          <form method="POST" action="{{ url_for('orders.place_order', pid=p[0]) }}">
            <input type="number" name="quantity" min="1" max="{{ p[3] }}" class="form-control mb-2" placeholder="Qty" required>
            <button type="submit" class="btn btn-success w-100">Order</button>
          </form>
        {% elif role == "Seller" %}
          <form method="POST" action="{{ url_for('products.update_product', pid=p[0]) }}">
            <input name="price" class="form-control mb-2" placeholder="New Price" required>
            <input name="stock" class="form-control mb-2" placeholder="New Stock" required>
            <button type="submit" class="btn btn-warning w-100">Update</button>
          </form>
        {% endif %}
      </div>
    </div>
  </div>
  {% endfor %}
</div>

{% if role == "Seller" %}
<hr>
<h3>Add New Product</h3>
<form method="POST" action="{{ url_for('products.add_product') }}" class="row g-3">
  <div class="col-md-4"><input name="name" class="form-control" placeholder="Product Name" required></div>
  <div class="col-md-3"><input name="price" class="form-control" placeholder="Price" required></div>
  <div class="col-md-3"><input name="stock" class="form-control" placeholder="Stock" required></div>
  <div class="col-md-2"><button type="submit" class="btn btn-primary w-100">Add</button></div>
</form>
{% endif %}
{% endblock %}
